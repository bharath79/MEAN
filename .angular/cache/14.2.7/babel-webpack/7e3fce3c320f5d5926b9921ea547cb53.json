{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { mimeType } from './mime-type.validator';\nlet PostCreateComponent = class PostCreateComponent {\n  constructor(postsService, route) {\n    this.postsService = postsService;\n    this.route = route;\n    this.k = '';\n    this.v = '';\n    this.isLoading = false;\n    this.mode = 'create';\n  }\n\n  ngOnInit() {\n    this.form = new FormGroup({\n      title: new FormControl(null, {\n        validators: [Validators.required, Validators.minLength(3)]\n      }),\n      content: new FormControl(null, {\n        validators: [Validators.required]\n      }),\n      image: new FormControl(null, {\n        validators: [Validators.required],\n        asyncValidators: [mimeType]\n      })\n    });\n    this.route.paramMap.subscribe(data => {\n      if (data.has('id')) {\n        this.mode = 'edit';\n        this.id = data.get('id');\n        this.isLoading = true;\n        this.postsService.getPost(this.id).subscribe(postData => {\n          this.isLoading = false;\n          this.post = {\n            id: postData._id,\n            title: postData.title,\n            content: postData.content\n          };\n          this.form.setValue({\n            title: this.post.title,\n            content: this.post.content\n          });\n        });\n      } else {\n        this.mode = 'create';\n        this.id = null;\n      }\n    });\n  }\n\n  onImagePicked(event) {\n    const file = event.target.files[0];\n    this.form.patchValue({\n      image: file\n    });\n    this.form.get('image').updateValueAndValidity();\n    const reader = new FileReader();\n\n    reader.onload = () => {\n      this.imagePreview = reader.result.toString();\n    };\n\n    reader.readAsDataURL(file);\n  }\n\n  onSave() {\n    if (this.form.invalid) return;\n    this.isLoading = true;\n\n    if (this.mode === 'create') {\n      this.postsService.setPosts(this.form.value.title, this.form.value.content, this.form.value.image);\n    } else {\n      this.postsService.updatePost(this.id, this.form.value.title, this.form.value.content);\n    }\n\n    this.form.reset();\n  }\n\n};\nPostCreateComponent = __decorate([Component({\n  selector: 'app-post-create',\n  templateUrl: './post-create.component.html',\n  styleUrls: ['./post-create.component.css']\n})], PostCreateComponent);\nexport { PostCreateComponent };","map":{"version":3,"mappings":";AAAA,SAASA,SAAT,QAAkC,eAAlC;AACA,SAASC,WAAT,EAAsBC,SAAtB,EAAiCC,UAAjC,QAAmD,gBAAnD;AAIA,SAASC,QAAT,QAAyB,uBAAzB;AAOA,IAAaC,mBAAmB,GAAhC,MAAaA,mBAAb,CAAgC;EAU9BC,YACSC,YADT,EAESC,KAFT,EAE8B;IADrB;IACA;IAXT,SAAI,EAAJ;IACA,SAAI,EAAJ;IACA,iBAAY,KAAZ;IACQ,YAAO,QAAP;EASJ;;EAEJC,QAAQ;IACN,KAAKC,IAAL,GAAY,IAAIR,SAAJ,CAAc;MACxBS,KAAK,EAAE,IAAIV,WAAJ,CAAgB,IAAhB,EAAsB;QAC3BW,UAAU,EAAE,CAACT,UAAU,CAACU,QAAZ,EAAsBV,UAAU,CAACW,SAAX,CAAqB,CAArB,CAAtB;MADe,CAAtB,CADiB;MAIxBC,OAAO,EAAE,IAAId,WAAJ,CAAgB,IAAhB,EAAsB;QAAEW,UAAU,EAAE,CAACT,UAAU,CAACU,QAAZ;MAAd,CAAtB,CAJe;MAKxBG,KAAK,EAAE,IAAIf,WAAJ,CAAgB,IAAhB,EAAsB;QAC3BW,UAAU,EAAE,CAACT,UAAU,CAACU,QAAZ,CADe;QAE3BI,eAAe,EAAE,CAACb,QAAD;MAFU,CAAtB;IALiB,CAAd,CAAZ;IAUA,KAAKI,KAAL,CAAWU,QAAX,CAAoBC,SAApB,CAA+BC,IAAD,IAAmB;MAC/C,IAAIA,IAAI,CAACC,GAAL,CAAS,IAAT,CAAJ,EAAoB;QAClB,KAAKC,IAAL,GAAY,MAAZ;QACA,KAAKC,EAAL,GAAUH,IAAI,CAACI,GAAL,CAAS,IAAT,CAAV;QACA,KAAKC,SAAL,GAAiB,IAAjB;QACA,KAAKlB,YAAL,CAAkBmB,OAAlB,CAA0B,KAAKH,EAA/B,EAAmCJ,SAAnC,CAA8CQ,QAAD,IAAa;UACxD,KAAKF,SAAL,GAAiB,KAAjB;UACA,KAAKG,IAAL,GAAY;YACVL,EAAE,EAAEI,QAAQ,CAACE,GADH;YAEVlB,KAAK,EAAEgB,QAAQ,CAAChB,KAFN;YAGVI,OAAO,EAAEY,QAAQ,CAACZ;UAHR,CAAZ;UAKA,KAAKL,IAAL,CAAUoB,QAAV,CAAmB;YACjBnB,KAAK,EAAE,KAAKiB,IAAL,CAAUjB,KADA;YAEjBI,OAAO,EAAE,KAAKa,IAAL,CAAUb;UAFF,CAAnB;QAID,CAXD;MAYD,CAhBD,MAgBO;QACL,KAAKO,IAAL,GAAY,QAAZ;QACA,KAAKC,EAAL,GAAU,IAAV;MACD;IACF,CArBD;EAsBD;;EAEDQ,aAAa,CAACC,KAAD,EAAa;IACxB,MAAMC,IAAI,GAAID,KAAK,CAACE,MAAN,CAAkCC,KAAlC,CAAwC,CAAxC,CAAd;IACA,KAAKzB,IAAL,CAAU0B,UAAV,CAAqB;MAAEpB,KAAK,EAAEiB;IAAT,CAArB;IACA,KAAKvB,IAAL,CAAUc,GAAV,CAAc,OAAd,EAAuBa,sBAAvB;IAEA,MAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;;IACAD,MAAM,CAACE,MAAP,GAAgB,MAAK;MACnB,KAAKC,YAAL,GAAoBH,MAAM,CAACI,MAAP,CAAcC,QAAd,EAApB;IACD,CAFD;;IAGAL,MAAM,CAACM,aAAP,CAAqBX,IAArB;EACD;;EACDY,MAAM;IACJ,IAAI,KAAKnC,IAAL,CAAUoC,OAAd,EAAuB;IAEvB,KAAKrB,SAAL,GAAiB,IAAjB;;IACA,IAAI,KAAKH,IAAL,KAAc,QAAlB,EAA4B;MAC1B,KAAKf,YAAL,CAAkBwC,QAAlB,CACE,KAAKrC,IAAL,CAAUsC,KAAV,CAAgBrC,KADlB,EAEE,KAAKD,IAAL,CAAUsC,KAAV,CAAgBjC,OAFlB,EAGE,KAAKL,IAAL,CAAUsC,KAAV,CAAgBhC,KAHlB;IAKD,CAND,MAMO;MACL,KAAKT,YAAL,CAAkB0C,UAAlB,CACE,KAAK1B,EADP,EAEE,KAAKb,IAAL,CAAUsC,KAAV,CAAgBrC,KAFlB,EAGE,KAAKD,IAAL,CAAUsC,KAAV,CAAgBjC,OAHlB;IAKD;;IAED,KAAKL,IAAL,CAAUwC,KAAV;EACD;;AAhF6B,CAAhC;AAAa7C,mBAAmB,eAL/BL,SAAS,CAAC;EACTmD,QAAQ,EAAE,iBADD;EAETC,WAAW,EAAE,8BAFJ;EAGTC,SAAS,EAAE,CAAC,6BAAD;AAHF,CAAD,CAKsB,GAAnBhD,mBAAmB,CAAnB;SAAAA","names":["Component","FormControl","FormGroup","Validators","mimeType","PostCreateComponent","constructor","postsService","route","ngOnInit","form","title","validators","required","minLength","content","image","asyncValidators","paramMap","subscribe","data","has","mode","id","get","isLoading","getPost","postData","post","_id","setValue","onImagePicked","event","file","target","files","patchValue","updateValueAndValidity","reader","FileReader","onload","imagePreview","result","toString","readAsDataURL","onSave","invalid","setPosts","value","updatePost","reset","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\bhara\\OneDrive\\Desktop\\vinay\\mean\\src\\app\\posts\\post-create\\post-create.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, ParamMap } from '@angular/router';\nimport { Post } from '../post.model';\nimport { PostsService } from '../posts.service';\nimport { mimeType } from './mime-type.validator';\n\n@Component({\n  selector: 'app-post-create',\n  templateUrl: './post-create.component.html',\n  styleUrls: ['./post-create.component.css'],\n})\nexport class PostCreateComponent implements OnInit {\n  k = '';\n  v = '';\n  isLoading = false;\n  private mode = 'create';\n  private id: string;\n  imagePreview: string;\n  post: Post;\n  form: FormGroup;\n\n  constructor(\n    public postsService: PostsService,\n    public route: ActivatedRoute\n  ) {}\n\n  ngOnInit() {\n    this.form = new FormGroup({\n      title: new FormControl(null, {\n        validators: [Validators.required, Validators.minLength(3)],\n      }),\n      content: new FormControl(null, { validators: [Validators.required] }),\n      image: new FormControl(null, {\n        validators: [Validators.required],\n        asyncValidators: [mimeType],\n      }),\n    });\n    this.route.paramMap.subscribe((data: ParamMap) => {\n      if (data.has('id')) {\n        this.mode = 'edit';\n        this.id = data.get('id');\n        this.isLoading = true;\n        this.postsService.getPost(this.id).subscribe((postData) => {\n          this.isLoading = false;\n          this.post = {\n            id: postData._id,\n            title: postData.title,\n            content: postData.content,\n          };\n          this.form.setValue({\n            title: this.post.title,\n            content: this.post.content,\n          });\n        });\n      } else {\n        this.mode = 'create';\n        this.id = null;\n      }\n    });\n  }\n\n  onImagePicked(event: Event) {\n    const file = (event.target as HTMLInputElement).files[0];\n    this.form.patchValue({ image: file });\n    this.form.get('image').updateValueAndValidity();\n\n    const reader = new FileReader();\n    reader.onload = () => {\n      this.imagePreview = reader.result.toString();\n    };\n    reader.readAsDataURL(file);\n  }\n  onSave() {\n    if (this.form.invalid) return;\n\n    this.isLoading = true;\n    if (this.mode === 'create') {\n      this.postsService.setPosts(\n        this.form.value.title,\n        this.form.value.content,\n        this.form.value.image\n      );\n    } else {\n      this.postsService.updatePost(\n        this.id,\n        this.form.value.title,\n        this.form.value.content\n      );\n    }\n\n    this.form.reset();\n  }\n}\n"]},"metadata":{},"sourceType":"module"}